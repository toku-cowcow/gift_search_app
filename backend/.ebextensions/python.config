option_settings:
  # Python プラットフォーム設定 (Amazon Linux 2023)
  aws:elasticbeanstalk:container:python:
    WSGIPath: application:application
    
  # アプリケーション環境変数（全て統合）
  aws:elasticbeanstalk:application:environment:
    GUNICORN_CMD_ARGS: "--worker-class uvicorn.workers.UvicornWorker"
    ENVIRONMENT: production
    LOG_LEVEL: INFO
    PYTHONPATH: /var/app/current
    PIP_CACHE_DIR: /tmp/pip-cache
    
  # インスタンス設定
  aws:autoscaling:launchconfiguration:
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role
    InstanceType: t3.micro  # 必要に応じて変更
    
  # ロードバランサー設定
  aws:elasticbeanstalk:environment:
    EnvironmentType: LoadBalanced
    LoadBalancerType: application
    
  # ヘルスチェック設定
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
    
  aws:elasticbeanstalk:command:
    BatchSize: 30
    BatchSizeType: Percentage
    
  # プロセス設定
  aws:elasticbeanstalk:environment:process:default:
    HealthCheckPath: /health
    HealthCheckInterval: 15
    HealthyThresholdCount: 3
    Port: 80
    Protocol: HTTP
    UnhealthyThresholdCount: 5
    DeregistrationDelay: 20
    MatcherHTTPCode: 200